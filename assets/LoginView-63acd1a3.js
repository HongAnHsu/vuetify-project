import{$ as S,aA as B,a0 as C,av as F,a4 as q,a6 as M,a7 as o,c as a,aB as m,ab as s,aq as N,ar as p,ad as t,K as g,af as h}from"./index-f6e31abf.js";import{c as R,a as b,u as U,d as f}from"./index.esm-29269589.js";import{V as $}from"./VContainer-ce4e7f04.js";import{V as c,a as _}from"./VRow-36f85e00.js";import{V as P}from"./VForm-a88f63cc.js";import"./_commonjsHelpers-39b5b250.js";const T=t("h1",null," ",-1),A=t("h1",{style:{color:"white"}},"登入",-1),D={class:"text-center"},K=t("h1",null,null,-1),J={__name:"LoginView",setup(L){const i=S(),d=B(),V=C(),w=()=>{d.push("/register")},v=R({account:b().required("帳號必填").min(4,"帳號最少 4 個字").max(20,"帳號最多 20 個字"),password:b().required("密碼必填").min(4,"密碼最少 4 個字").max(20,"密碼最多 20 個字")}),{handleSubmit:k,isSubmitting:x}=U({validationSchema:v}),r=f("account"),l=f("password"),y=k(async n=>{try{const{data:e}=await F.post("/users/login",{account:n.account,password:n.password});V.login({token:e.result.token,account:e.result.account,email:e.result.email,cart:e.result.cart,role:e.result.role}),i({text:"成功登入",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),d.push("/")}catch(e){i({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(n,e)=>(q(),M($,null,{default:o(()=>[a(_,null,{default:o(()=>[a(c,{cols:"12"},{default:o(()=>[T,A]),_:1}),a(m,{thickness:3,class:"border-opacity-100",color:"warning"}),a(c,{cols:"12"},{default:o(()=>[a(P,{disabled:s(x),onSubmit:N(s(y),["prevent"])},{default:o(()=>[a(p,{modelValue:s(r).value.value,"onUpdate:modelValue":e[0]||(e[0]=u=>s(r).value.value=u),"error-messages":s(r).errorMessage.value,label:"帳號",counter:"",maxlength:"20",color:"orange",style:{background:"white"}},null,8,["modelValue","error-messages"]),a(p,{modelValue:s(l).value.value,"onUpdate:modelValue":e[1]||(e[1]=u=>s(l).value.value=u),"error-messages":s(l).errorMessage.value,label:"密碼",counter:"",maxlength:"20",type:"password",color:"orange",style:{background:"white"}},null,8,["modelValue","error-messages"]),t("div",D,[a(_,null,{default:o(()=>[a(c,{cols:"12"},{default:o(()=>[a(g,{type:"submit",color:"orange",style:{margin:"1%"}},{default:o(()=>[h("登入")]),_:1}),K,a(g,{color:"white",onClick:w},{default:o(()=>[h("前往註冊")]),_:1})]),_:1})]),_:1})])]),_:1},8,["disabled","onSubmit"])]),_:1}),a(m,{thickness:3,class:"border-opacity-100",color:"warning",style:{margin:""}})]),_:1})]),_:1}))}};export{J as default};
