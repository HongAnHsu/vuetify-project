import{$ as S,a0 as B,a1 as C,aw as F,a5 as M,a7 as N,a8 as o,c as a,aB as m,ac as s,ar as R,as as p,ae as t,K as g,ag as h}from"./index-fa1a3a97.js";import{c as U,a as _,u as $,d as b}from"./index.esm-ba533ca2.js";import{V as q}from"./VContainer-7de799d6.js";import{V as c,a as f}from"./VRow-24d4f13e.js";import{V as P}from"./VForm-274d40d0.js";import"./_commonjsHelpers-39b5b250.js";const T=t("h1",null," ",-1),D=t("h1",{style:{color:"white"}},"登入",-1),K={class:"text-center"},L=t("h1",null,null,-1),J={__name:"LoginView",setup(j){const i=S(),d=B(),w=C(),V=()=>{d.push("/register")},k=U({account:_().required("帳號必填").min(4,"帳號最少 4 個字").max(20,"帳號最多 20 個字"),password:_().required("密碼必填").min(4,"密碼最少 4 個字").max(20,"密碼最多 20 個字")}),{handleSubmit:v,isSubmitting:x}=$({validationSchema:k}),r=b("account"),l=b("password"),y=v(async n=>{try{const{data:e}=await F.post("/users/login",{account:n.account,password:n.password});w.login({token:e.result.token,account:e.result.account,email:e.result.email,cart:e.result.cart,role:e.result.role}),i({text:"成功登入",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),d.push("/")}catch(e){i({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(n,e)=>(M(),N(q,null,{default:o(()=>[a(f,null,{default:o(()=>[a(c,{cols:"12"},{default:o(()=>[T,D]),_:1}),a(m,{thickness:3,class:"border-opacity-100",color:"warning"}),a(c,{cols:"12"},{default:o(()=>[a(P,{disabled:s(x),onSubmit:R(s(y),["prevent"])},{default:o(()=>[a(p,{modelValue:s(r).value.value,"onUpdate:modelValue":e[0]||(e[0]=u=>s(r).value.value=u),"error-messages":s(r).errorMessage.value,label:"帳號",counter:"",maxlength:"20",color:"orange",style:{background:"white"}},null,8,["modelValue","error-messages"]),a(p,{modelValue:s(l).value.value,"onUpdate:modelValue":e[1]||(e[1]=u=>s(l).value.value=u),"error-messages":s(l).errorMessage.value,label:"密碼",counter:"",maxlength:"20",type:"password",color:"orange",style:{background:"white"}},null,8,["modelValue","error-messages"]),t("div",K,[a(f,null,{default:o(()=>[a(c,{cols:"12"},{default:o(()=>[a(g,{type:"submit",color:"orange",style:{margin:"1%"}},{default:o(()=>[h("登入")]),_:1}),L,a(g,{color:"white",onClick:V},{default:o(()=>[h("前往註冊")]),_:1})]),_:1})]),_:1})])]),_:1},8,["disabled","onSubmit"])]),_:1}),a(m,{thickness:3,class:"border-opacity-100",color:"warning",style:{margin:""}})]),_:1})]),_:1}))}};export{J as default};
