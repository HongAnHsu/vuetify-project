import{aC as b,$ as h,a1 as x,ak as w,x as S,aw as k,a5 as q,a6 as B,c as t,a8 as s,aD as C,aa as F,ae as u,aj as n,V as $,ac as l,ar as M,as as N,K as m,ag as d}from"./index-fa1a3a97.js";import{c as P,e as j,u as D,d as E}from"./index.esm-ba533ca2.js";import{V as R}from"./VContainer-7de799d6.js";import{a as T,V as i}from"./VRow-24d4f13e.js";import{V as U}from"./VForm-274d40d0.js";import"./_commonjsHelpers-39b5b250.js";const A=u("h1",{class:"text-red"},"已下架",-1),L={__name:"ProductView",setup(I){const p=b(),c=h(),v=x(),f=P({quantity:j().typeError("缺少數量").required("缺少數量").min(1,"最少為 1")}),{isSubmitting:_,handleSubmit:g}=D({validationSchema:f,initialValues:{quantity:0}}),o=E("quantity"),V=g(async a=>{try{const{data:r}=await w.post("/users/cart",{product:e.value._id,quantity:a.quantity});v.cart=r.result}catch(r){c({text:r.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),e=S({_id:"",name:"",price:0,description:"",image:"",sell:!0,category:""});return(async()=>{try{const{data:a}=await k.get("/products/"+p.params.id);e.value._id=a.result._id,e.value.name=a.result.name,e.value.price=a.result.price,e.value.description=a.result.description,e.value.image=a.result.image,e.value.sell=a.result.sell,e.value.category=a.result.category,document.title="購物網 | "+e.value.name}catch(a){c({text:a.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})(),(a,r)=>(q(),B(F,null,[t(R,null,{default:s(()=>[t(T,null,{default:s(()=>[t(i,{cols:"12"},{default:s(()=>[u("h1",null,n(e.value.name),1)]),_:1}),t(i,{cols:"12",md:"6"},{default:s(()=>[t($,{src:e.value.image},null,8,["src"])]),_:1}),t(i,{cols:"12",md:"6"},{default:s(()=>[u("p",null,"$"+n(e.value.price*l(o).value.value),1),u("pre",null,n(e.value.name),1),t(U,{disabled:l(_),onSubmit:M(l(V),["prevent"])},{default:s(()=>[t(N,{modelValue:l(o).value.value,"onUpdate:modelValue":r[0]||(r[0]=y=>l(o).value.value=y),modelModifiers:{number:!0},type:"number",label:"數量",min:"0","error-messages":l(o).errorMessage.value},null,8,["modelValue","error-messages"]),t(m,{type:"submit",color:"green"},{default:s(()=>[d("加入購物車")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}),t(C,{"model-value":!e.value.sell,persistent:"",class:"align-center text-center justify-center"},{default:s(()=>[A,t(m,{to:"/"},{default:s(()=>[d("回上頁")]),_:1})]),_:1},8,["model-value"])],64))}};export{L as default};
